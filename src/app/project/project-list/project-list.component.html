<section class="project-container">
  <h2>My Projects</h2>

  <form (ngSubmit)="addProject(); $event.preventDefault()" class="add-form">
    <input
      type="text"
      placeholder="New Project"
      [ngModel]="newProjectName()"
      (ngModelChange)="newProjectName.set($event)"
      name="projectName"
    />
    <button type="submit" [disabled]="!newProjectName()">Add Project</button>
  </form>

  <ul>
    @for (p of projects(); track p.id) {
      <li class="project-card">
        <div class="project-header">
          <h3 (click)="selectProject(p.id)">
            {{ p.name }}
            <span class="toggle">
              {{ selectedProjectId() === p.id ? '▲' : '▼' }}
            </span>
          </h3>
          <button (click)="removeProject(p.id)">✖</button>
        </div>

        <section *ngIf="selectedProjectId() === p.id" class="project-content">
          <div class="toolbar">
            <button [class.active]="activeTab() === 'forces'" (click)="setActiveTab('forces')">Forces</button>
            <button [class.active]="activeTab() === 'units'" (click)="setActiveTab('units')">Units</button>
            <button [class.active]="activeTab() === 'minis'" (click)="setActiveTab('minis')">Minis</button>
          </div>

          <div class="tab-content">
            @switch (activeTab()) {
              @case ('forces') { <app-force-list [projectId]="p.id"></app-force-list> }
              @case ('units') { <app-unit-list [projectId]="p.id"></app-unit-list> }
              @case ('minis') { <app-mini-list [projectId]="p.id"></app-mini-list> }
            }
          </div>
        </section>
      </li>
    } @empty {
      <p>No projects yet — add one above!</p>
    }
  </ul>
</section>
